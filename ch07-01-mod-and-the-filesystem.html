<!DOCTYPE HTML>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>mod and the Filesystem - </title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <base href="">

        <link rel="stylesheet" href="book.css">
        <link href="https://fonts.googleapis.com/css?family=Open+Sans:300italic,400italic,600italic,700italic,800italic,400,300,600,700,800" rel="stylesheet" type="text/css">
        <link href="https://fonts.googleapis.com/css?family=Source+Code+Pro:500" rel="stylesheet" type="text/css">

        <link rel="shortcut icon" href="favicon.png">

        <!-- Font Awesome -->
        <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.3.0/css/font-awesome.min.css">

        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme -->
        

        

        <!-- Fetch Clipboard.js from CDN but have a local fallback -->
        <script src="https://cdn.jsdelivr.net/clipboard.js/1.6.1/clipboard.min.js"></script>
        <script>
            if (typeof Clipboard == 'undefined') {
                document.write(unescape("%3Cscript src='clipboard.min.js'%3E%3C/script%3E"));
            }
        </script>

    </head>
    <body class="light">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { } 
            if (theme === null || theme === undefined) { theme = 'light'; }
            document.body.className = theme;
            document.querySelector('html').className = theme;
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            document.querySelector('html').classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <ol class="chapter"><li><a href="ch01-00-introduction.html"><strong aria-hidden="true">1.</strong> üáßüá∑ Introdu√ß√£o</a></li><li><ol class="section"><li><a href="ch01-01-installation.html"><strong aria-hidden="true">1.1.</strong> Installation</a></li><li><a href="ch01-02-hello-world.html"><strong aria-hidden="true">1.2.</strong> Hello, World!</a></li></ol></li><li><a href="ch02-00-guessing-game-tutorial.html"><strong aria-hidden="true">2.</strong> Guessing Game Tutorial</a></li><li><a href="ch03-00-common-programming-concepts.html"><strong aria-hidden="true">3.</strong> üáßüá∑ Conceitos Comuns de Programa√ß√£o</a></li><li><ol class="section"><li><a href="ch03-01-variables-and-mutability.html"><strong aria-hidden="true">3.1.</strong> üáßüá∑ Vari√°veis e Mutabilidade</a></li><li><a href="ch03-02-data-types.html"><strong aria-hidden="true">3.2.</strong> Data Types</a></li><li><a href="ch03-03-how-functions-work.html"><strong aria-hidden="true">3.3.</strong> How Functions Work</a></li><li><a href="ch03-04-comments.html"><strong aria-hidden="true">3.4.</strong> Comments</a></li><li><a href="ch03-05-control-flow.html"><strong aria-hidden="true">3.5.</strong> Control Flow</a></li></ol></li><li><a href="ch04-00-understanding-ownership.html"><strong aria-hidden="true">4.</strong> Understanding Ownership</a></li><li><ol class="section"><li><a href="ch04-01-what-is-ownership.html"><strong aria-hidden="true">4.1.</strong> What is Ownership?</a></li><li><a href="ch04-02-references-and-borrowing.html"><strong aria-hidden="true">4.2.</strong> References &amp; Borrowing</a></li><li><a href="ch04-03-slices.html"><strong aria-hidden="true">4.3.</strong> Slices</a></li></ol></li><li><a href="ch05-00-structs.html"><strong aria-hidden="true">5.</strong> Structs</a></li><li><ol class="section"><li><a href="ch05-01-method-syntax.html"><strong aria-hidden="true">5.1.</strong> Method Syntax</a></li></ol></li><li><a href="ch06-00-enums.html"><strong aria-hidden="true">6.</strong> Enums and Pattern Matching</a></li><li><ol class="section"><li><a href="ch06-01-defining-an-enum.html"><strong aria-hidden="true">6.1.</strong> Defining an Enum</a></li><li><a href="ch06-02-match.html"><strong aria-hidden="true">6.2.</strong> The match Control Flow Operator</a></li><li><a href="ch06-03-if-let.html"><strong aria-hidden="true">6.3.</strong> Concise Control Flow with if let</a></li></ol></li><li><a href="ch07-00-modules.html"><strong aria-hidden="true">7.</strong> Modules</a></li><li><ol class="section"><li><a href="ch07-01-mod-and-the-filesystem.html" class="active"><strong aria-hidden="true">7.1.</strong> mod and the Filesystem</a></li><li><a href="ch07-02-controlling-visibility-with-pub.html"><strong aria-hidden="true">7.2.</strong> Controlling Visibility with pub</a></li><li><a href="ch07-03-importing-names-with-use.html"><strong aria-hidden="true">7.3.</strong> Importing Names with use</a></li></ol></li><li><a href="ch08-00-fundamental-collections.html"><strong aria-hidden="true">8.</strong> Fundamental Collections</a></li><li><ol class="section"><li><a href="ch08-01-vectors.html"><strong aria-hidden="true">8.1.</strong> Vectors</a></li><li><a href="ch08-02-strings.html"><strong aria-hidden="true">8.2.</strong> Strings</a></li><li><a href="ch08-03-hash-maps.html"><strong aria-hidden="true">8.3.</strong> Hash Maps</a></li></ol></li><li><a href="ch09-00-error-handling.html"><strong aria-hidden="true">9.</strong> Error Handling</a></li><li><ol class="section"><li><a href="ch09-01-unrecoverable-errors-with-panic.html"><strong aria-hidden="true">9.1.</strong> Unrecoverable Errors with panic!</a></li><li><a href="ch09-02-recoverable-errors-with-result.html"><strong aria-hidden="true">9.2.</strong> Recoverable Errors with Result</a></li><li><a href="ch09-03-to-panic-or-not-to-panic.html"><strong aria-hidden="true">9.3.</strong> To panic! or Not To panic!</a></li></ol></li><li><a href="ch10-00-generics.html"><strong aria-hidden="true">10.</strong> Generics</a></li><li><ol class="section"><li><a href="ch10-01-syntax.html"><strong aria-hidden="true">10.1.</strong> Syntax</a></li><li><a href="ch10-02-traits.html"><strong aria-hidden="true">10.2.</strong> Traits</a></li><li><a href="ch10-03-lifetime-syntax.html"><strong aria-hidden="true">10.3.</strong> Lifetime syntax</a></li></ol></li><li><a href="ch11-00-testing.html"><strong aria-hidden="true">11.</strong> Testing</a></li><li><ol class="section"><li><a href="ch11-01-writing-tests.html"><strong aria-hidden="true">11.1.</strong> Writing tests</a></li><li><a href="ch11-02-running-tests.html"><strong aria-hidden="true">11.2.</strong> Running tests</a></li><li><a href="ch11-03-test-organization.html"><strong aria-hidden="true">11.3.</strong> Test Organization</a></li></ol></li><li><a href="ch12-00-an-io-project.html"><strong aria-hidden="true">12.</strong> An I/O Project</a></li><li><ol class="section"><li><a href="ch12-01-accepting-command-line-arguments.html"><strong aria-hidden="true">12.1.</strong> Accepting Command Line Arguments</a></li><li><a href="ch12-02-reading-a-file.html"><strong aria-hidden="true">12.2.</strong> Reading a File</a></li><li><a href="ch12-03-improving-error-handling-and-modularity.html"><strong aria-hidden="true">12.3.</strong> Improving Error Handling and Modularity</a></li><li><a href="ch12-04-testing-the-librarys-functionality.html"><strong aria-hidden="true">12.4.</strong> Testing the Library's Functionality</a></li><li><a href="ch12-05-working-with-environment-variables.html"><strong aria-hidden="true">12.5.</strong> Working with Environment Variables</a></li><li><a href="ch12-06-writing-to-stderr-instead-of-stdout.html"><strong aria-hidden="true">12.6.</strong> Writing to stderr instead of stdout</a></li></ol></li><li><a href="ch13-00-functional-features.html"><strong aria-hidden="true">13.</strong> Functional Language Features in Rust</a></li><li><ol class="section"><li><a href="ch13-01-closures.html"><strong aria-hidden="true">13.1.</strong> Closures</a></li><li><a href="ch13-02-iterators.html"><strong aria-hidden="true">13.2.</strong> Iterators</a></li><li><a href="ch13-03-improving-our-io-project.html"><strong aria-hidden="true">13.3.</strong> Improving our I/O Project</a></li><li><a href="ch13-04-performance.html"><strong aria-hidden="true">13.4.</strong> Performance</a></li></ol></li><li><a href="ch14-00-more-about-cargo.html"><strong aria-hidden="true">14.</strong> More about Cargo and Crates.io</a></li><li><ol class="section"><li><a href="ch14-01-release-profiles.html"><strong aria-hidden="true">14.1.</strong> Release Profiles</a></li><li><a href="ch14-02-publishing-to-crates-io.html"><strong aria-hidden="true">14.2.</strong> Publishing a Crate to Crates.io</a></li><li><a href="ch14-03-cargo-workspaces.html"><strong aria-hidden="true">14.3.</strong> Cargo Workspaces</a></li><li><a href="ch14-04-installing-binaries.html"><strong aria-hidden="true">14.4.</strong> Installing Binaries from Crates.io with cargo install</a></li><li><a href="ch14-05-extending-cargo.html"><strong aria-hidden="true">14.5.</strong> Extending Cargo with Custom Commands</a></li></ol></li><li><a href="ch15-00-smart-pointers.html"><strong aria-hidden="true">15.</strong> Smart Pointers</a></li><li><a href="ch16-00-concurrency.html"><strong aria-hidden="true">16.</strong> Concurrency</a></li><li><a href="ch17-00-oop.html"><strong aria-hidden="true">17.</strong> Is Rust OOP?</a></li><li><a href="ch18-00-patterns.html"><strong aria-hidden="true">18.</strong> Patterns</a></li><li><a href="ch19-00-more-lifetimes.html"><strong aria-hidden="true">19.</strong> More Lifetimes</a></li><li><a href="ch20-00-advanced-types.html"><strong aria-hidden="true">20.</strong> Advanced Type System Features</a></li><li><a href="appendix-00.html"><strong aria-hidden="true">21.</strong> Appendix</a></li><li><ol class="section"><li><a href="appendix-01-keywords.html"><strong aria-hidden="true">21.1.</strong> Keywords</a></li><li><a href="appendix-02-operators.html"><strong aria-hidden="true">21.2.</strong> Operators</a></li><li><a href="appendix-03-derivable-traits.html"><strong aria-hidden="true">21.3.</strong> Derivable Traits</a></li><li><a href="appendix-04-nightly-rust.html"><strong aria-hidden="true">21.4.</strong> Nightly Rust</a></li><li><a href="appendix-05-macros.html"><strong aria-hidden="true">21.5.</strong> Macros</a></li></ol></li></ol>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar" class="menu-bar">
                    <div id="menu-bar-sticky-container">
                        <div class="left-buttons">
                            <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                                <i class="fa fa-bars"></i>
                            </button>
                            <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                                <i class="fa fa-paint-brush"></i>
                            </button>
                            <ul id="theme-list" class="theme-popup" aria-label="submenu">
                                <li><button class="theme" id="light">Light <span class="default">(default)</span></button></li>
                                <li><button class="theme" id="rust">Rust</button></li>
                                <li><button class="theme" id="coal">Coal</button></li>
                                <li><button class="theme" id="navy">Navy</button></li>
                                <li><button class="theme" id="ayu">Ayu</button></li>
                            </ul>
                        </div>

                        <h1 class="menu-title"></h1>

                        <div class="right-buttons">
                            <a href="print.html" title="Print this book" aria-label="Print this book">
                                <i id="print-button" class="fa fa-print"></i>
                            </a>
                        </div>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <a class="header" href="ch07-01-mod-and-the-filesystem.html#mod-e-o-sistema-de-arquivos" id="mod-e-o-sistema-de-arquivos"><h2><code>mod</code> e o Sistema de Arquivos</h2></a>
<p>Vamos iniciar o nosso exemplo de m√≥dulo fazendo um novo projeto com o Cargo, mas em vez de
criar um crate bin√°rio, faremos um crate de biblioteca: um projeto que
as outras pessoas podem puxar para os seus projetos como uma depend√™ncia. Por exemplo, o crate <code>rand</code>
discutido no Cap√≠tulo 2, √© um crate de biblioteca que usamos como uma depend√™ncia no
projeto do jogo de adivinha√ß√£o.</p>
<p>Criaremos um esqueleto de uma biblioteca que fornece algumas funcionalidades gerais
de rede; nos concentraremos na organiza√ß√£o dos m√≥dulos e fun√ß√µes,
mas n√£o nos preocuparemos com o c√≥digo que est√° dentro das fun√ß√µes. Chamaremos
nossa biblioteca de <code>communicator</code>. Por padr√£o, o Cargo criar√° uma biblioteca, a menos que
outro tipo de projeto seja especificado: se omitimos a op√ß√£o <code>--bin</code>, que temos
usado em todos os cap√≠tulos anteriores a este, nosso projeto ser√° um
biblioteca:</p>
<pre><code class="language-text">$ cargo new communicator
$ cd communicator
</code></pre>
<p>Observe que Cargo gerou <em>src/lib.rs</em> em vez de <em>src/main.rs</em>. Dentro de
<em>src/lib.rs</em> encontraremos o seguinte:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
#[cfg(test)]
mod tests {
    #[test]
    fn it_works() {
        assert_eq!(2 + 2, 4);
    }
}
#}</code></pre></pre>
<p>Cargo cria um teste de exemplo para nos ajudar a come√ßar nossa biblioteca, em vez de
o bin√°rio ‚ÄúHello, world!‚Äù que recebemos quando usamos a op√ß√£o <code>--bin</code>. Olharemos
a sintaxe <code>#[]</code> e <code>mod tests</code> no ‚ÄúUsando <code>super</code> para Acessar um
M√≥dulo Pai‚Äù mais adiante neste cap√≠tulo, mas por agora, deixe este c√≥digo
na parte inferior de <em>src/lib.rs</em>.</p>
<p>Como n√£o temos um arquivo <em>src/main.rs</em>, n√£o h√° nada para ser executado pelo Cargo
com o comando <code>cargo run</code>. Portanto, usaremos o comando  <code>cargo build</code>
para compilar o c√≥digo da nossa biblioteca.</p>
<p>Examinaremos diferentes op√ß√µes para organizar o c√≥digo da sua biblioteca que ser√£o
adequados em uma variedade de situa√ß√µes, dependendo da inten√ß√£o do c√≥digo.</p>
<a class="header" href="ch07-01-mod-and-the-filesystem.html#defini√ß√µes-do-m√≥dulo" id="defini√ß√µes-do-m√≥dulo"><h3>Defini√ß√µes do M√≥dulo</h3></a>
<p>Para a nossa biblioteca de rede <code>communicator</code>, primeiro definiremos um m√≥dulo chamado
<code>network</code> que cont√©m a defini√ß√£o de uma fun√ß√£o chamada<code>connect</code>. Cada
defini√ß√£o de m√≥dulo em Rust come√ßa com a palavra-chave <code>mod</code>. Adicione este c√≥digo ao
in√≠cio do arquivo <em>src/lib.rs</em>, acima do c√≥digo de teste:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
mod network {
    fn connect() {
    }
}
#}</code></pre></pre>
<p>Ap√≥s a palavra-chave <code>mod</code>, colocamos o nome do m√≥dulo, <code>network</code> e, em seguida, um
bloco de c√≥digo entre chaves. Tudo dentro deste bloco est√° dentro do
namespace <code>network</code>. Neste caso, temos uma √∫nica fun√ß√£o, <code>connect</code>. Se n√≥s
quisermos chamar essa fun√ß√£o do c√≥digo fora do m√≥dulo <code>network</code>, n√≥s
precisaremos especificar o m√≥dulo e usar a sintaxe do namespace <code>::</code>, assim:
<code>network::connect()</code> em vez de apenas <code>connect()</code>.</p>
<p>Tamb√©m podemos ter m√∫ltiplos m√≥dulos, lado a lado, no mesmo arquivo <em>src/lib.rs</em>.
Por exemplo, para ter mais um m√≥dulo <code>client</code> que possui uma fun√ß√£o chamada <code>connect</code>
, podemos adicion√°-lo como mostrado na Listagem 7-1:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
mod network {
    fn connect() {
    }
}

mod client {
    fn connect() {
    }
}
#}</code></pre></pre>
<p><span class = "caption"> Listagem 7-1: O m√≥dulo <code>network</code> e o m√≥dulo <code>client</code>
definidos lado a lado em <em>src/lib.rs</em> </span></p>
<p>Agora, temos uma fun√ß√£o <code>network::connect</code> e uma fun√ß√£o <code>client::connect</code>.
Estas podem ter funcionalidades completamente diferentes, e os nomes das fun√ß√µes
n√£o est√£o em conflito entre si porque est√£o em m√≥dulos diferentes.</p>
<p>Nesse caso, como estamos construindo uma biblioteca, o arquivo que serve como
ponto de entrada para construir nossa biblioteca √© <em>src/lib.rs</em>. No entanto, em rela√ß√£o a
cria√ß√£o de m√≥dulos, n√£o h√° nada de especial sobre <em>src/lib.rs</em>. Poder√≠amos tamb√©m
criar m√≥dulos em <em>src/main.rs</em> para um crate bin√°rio da mesma forma que n√≥s
criamos m√≥dulos em <em>src/lib.rs</em> para o crate de biblioteca. Na verdade, podemos colocar m√≥dulos
dentro de m√≥dulos, o que pode ser √∫til √† medida que seus m√≥dulos crescem para manter juntas
funcionalidades relacionadas e separar funcionalidades n√£o relacionadas. A
escolha de como voc√™ organiza seu c√≥digo depende do que voc√™ pensa sobre a
rela√ß√£o entre as partes do seu c√≥digo. Por exemplo, o c√≥digo <code>client</code>
e a fun√ß√£o <code>connect</code> podem ter mais sentido para os usu√°rios de nossa biblioteca se
eles estivessem dentro do namespace <code>network</code>, como na Listagem 7-2:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
mod network {
    fn connect() {
    }

    mod client {
        fn connect() {
        }
    }
}
#}</code></pre></pre>
<p><span class = "caption"> Listagem 7-2: Movendo o m√≥dulo <code>client</code> para dentro do
m√≥dulo <code>network</code></span></p>
<p>No seu arquivo <em>src/lib.rs</em>, substitua as defini√ß√µes <code>mod network</code> e <code>mod client</code>
pelas da Listagem 7-2, que possuem o m√≥dulo <code>client</code> como um
m√≥dulo interno da <code>network</code>. Agora temos as fun√ß√µes <code>network::connect</code> e
<code>network::client::connect</code>: novamente, as duas fun√ß√µes denominadas <code>connect</code> n√£o conflitam
uma com a outra porque elas est√£o em diferentes namespaces.</p>
<p>Desta forma, os m√≥dulos formam uma hierarquia. O conte√∫do de <em>src/lib.rs</em> est√° no
n√≠vel superior mais alto, e os subm√≥dulos est√£o em n√≠veis mais baixos. Aqui est√°
a nossa organiza√ß√£o quando pensada de forma hier√°rquica na Listagem 7-1:</p>
<pre><code class="language-text">communicator
 ‚îú‚îÄ‚îÄ network
 ‚îî‚îÄ‚îÄ client
</code></pre>
<p>E aqui est√° a hierarquia correspondente ao exemplo na Listagem 7-2:</p>
<pre><code class="language-text">communicator
 ‚îî‚îÄ‚îÄ network
     ‚îî‚îÄ‚îÄ client
</code></pre>
<p>Conforme a hierarquia mostrada na Listagem 7-2, <code>client</code> √© um filho do m√≥dulo <code>network</code>
em vez de um irm√£o. Projetos mais complicados podem ter muitos m√≥dulos, √© necess√°rio
organiz√°-los logicamente para mant√™-los sob controle. O que &quot;logicamente&quot; significa em
seu projeto fica a seu crit√©rio, e depende do que voc√™ e os usu√°rios da sua biblioteca
pensam sobre o dom√≠nio do seu projeto. Use as t√©cnicas mostradas
aqui para criar m√≥dulos lado a lado e m√≥dulos aninhados em qualquer estrutura que
voc√™ queira.</p>
<a class="header" href="ch07-01-mod-and-the-filesystem.html#movendo-m√≥dulos-para-outros-arquivos" id="movendo-m√≥dulos-para-outros-arquivos"><h3>Movendo M√≥dulos para Outros Arquivos</h3></a>
<p>Os m√≥dulos formam uma estrutura hier√°rquica, bem parecida com outra estrutura computacional
que voc√™ conhece: sistemas de arquivos! Podemos usar o sistema de m√≥dulos do Rust juntamente com
v√°rios arquivos para dividir projetos Rust de forma que nem tudo resida em
<em>src/lib.rs</em> ou <em>src/main.rs</em>. Para este exemplo, vamos come√ßar com o c√≥digo em
Listagem 7-3:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
mod client {
    fn connect() {
    }
}

mod network {
    fn connect() {
    }

    mod server {
        fn connect() {
        }
    }
}
#}</code></pre></pre>
<p><span class="caption">Listagem 7-3: Tr√™s m√≥dulos, <code>client</code>, <code>network</code>, e
<code>network::server</code>, todos definidos em <em>src/lib.rs</em></span></p>
<p>O arquivo <em>src/lib.rs</em> possui esta hierarquia de m√≥dulos:</p>
<pre><code class="language-text">communicator
 ‚îú‚îÄ‚îÄ client
 ‚îî‚îÄ‚îÄ network
     ‚îî‚îÄ‚îÄ server
</code></pre>
<p>Se esses m√≥dulos tivessem muitas fun√ß√µes, e elas estivessem se alongando muito,
seria dif√≠cil percorrer esse arquivo para encontrar o c√≥digo com que queremos
trabalhar. Como as fun√ß√µes est√£o aninhadas dentro de um ou mais blocos <code>mod</code>,
as linhas de c√≥digo dentro das fun√ß√µes come√ßar√£o a se alongar tamb√©m.
Estes seriam bons motivos para separar os m√≥dulos <code>client</code>, <code>network</code>, e <code>server</code>
de <em>src/lib.rs</em> e coloc√°-los em seus pr√≥prios arquivos.</p>
<p>Primeiro, substitua o c√≥digo do m√≥dulo <code>client</code> por apenas a declara√ß√£o do
m√≥dulo <code>client</code>, para que seu <em>src/lib.rs</em> se pare√ßa com o c√≥digo mostrado na Listagem 7-4:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><code class="language-rust ignore">mod client;

mod network {
    fn connect() {
    }

    mod server {
        fn connect() {
        }
    }
}
</code></pre>
<p><span class="caption"> Listagem 7-4: Extraindo o conte√∫do do m√≥dulo <code>client</code>, mas deixando a declara√ß√£o em <em>src/lib.rs</em> </span></p>
<p>Ainda estamos <em>declarando</em> o m√≥dulo <code>client</code> aqui, mas ao substituir o bloco
por um ponto e v√≠rgula, estamos dizendo ao Rust para que procure, em outro local, o c√≥digo
definido no escopo do m√≥dulo <code>client</code>. Em outras palavras, a linha <code>mod client;</code> significa:</p>
<pre><code class="language-rust ignore">mod client {
    // conte√∫do de client.rs
}
</code></pre>
<p>Agora precisamos criar o arquivo externo com o nome do m√≥dulo. Crie um
arquivo <em>client.rs</em> em <em>src/</em> e abra-o. Em seguida digite o seguinte,
que √© a fun√ß√£o <code>connect</code> do m√≥dulo <code>client</code> que foi
removida na etapa anterior:</p>
<p><span class="filename">Arquivo: src/client.rs</span></p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
fn connect() {
}
#}</code></pre></pre>
<p>Observe que n√£o precisamos de uma declara√ß√£o <code>mod</code> neste arquivo porque j√° fizemos
a declara√ß√£o do m√≥dulo <code>client</code> com <code>mod</code> em <em>src/lib.rs</em>. Este arquivo apenas
fornece o <em>conte√∫do</em> do m√≥dulo <code>client</code>. Se colocarmos um <code>mod client</code> aqui,
n√≥s estar√≠amos dando ao m√≥dulo <code>client</code> seu pr√≥prio subm√≥dulo chamado <code>client</code>!</p>
<p>Rust s√≥ sabe olhar em <em>src/lib.rs</em> por padr√£o. Se quisermos adicionar mais
arquivos para o nosso projeto, precisamos dizer ao Rust em <em>src/lib.rs</em> para procurar em outros
arquivos; √© por isso que <code>mod client</code> precisa ser definido em <em>src/lib.rs</em> e n√£o pode
ser definido em <em>src/client.rs</em>.</p>
<p>Agora, o projeto deve compilar com sucesso, embora voc√™ obtenha alguns
warnings (avisos). Lembre-se de usar <code>cargo build</code>, em vez de <code>cargo run</code>, porque temos
um crate de biblioteca em vez de um crate bin√°rio:</p>
<pre><code class="language-text">$ cargo build
   Compiling communicator v0.1.0 (file:///projects/communicator)
warning: function is never used: `connect`
 --&gt; src/client.rs:1:1
  |
1 | / fn connect() {
2 | | }
  | |_^
  |
  = note: #[warn(dead_code)] on by default

warning: function is never used: `connect`
 --&gt; src/lib.rs:4:5
  |
4 | /     fn connect() {
5 | |     }
  | |_____^

warning: function is never used: `connect`
 --&gt; src/lib.rs:8:9
  |
8 | /         fn connect() {
9 | |         }
  | |_________^
</code></pre>
<p>Esses <em>warnings</em> nos dizem que temos fun√ß√µes que nunca s√£o usadas. N√£o se preocupe
com esses <em>warnings</em> por enquanto; vamos abord√°-los mais adiante neste cap√≠tulo, na
se√ß√£o ‚ÄúControlando a visibilidade com <code>pub</code>‚Äù. A boa not√≠cia √© que eles s√£o apenas
<em>warnings</em>; nosso projeto foi constru√≠do com sucesso!</p>
<p>Em seguida, vamos extrair o m√≥dulo <code>network</code> em seu pr√≥prio arquivo usando o mesmo
procedimento. Em <em>src/lib.rs</em>, exclua o corpo do m√≥dulo <code>network</code> e adicione um
ponto e v√≠rgula √† declara√ß√£o, assim:</p>
<p><span class="filename">Arquivo: src/lib.rs</span></p>
<pre><code class="language-rust ignore">mod client;

mod network;
</code></pre>
<p>Em seguida, crie um novo arquivo <em>src/network.rs</em> e digite o seguinte:</p>
<p><span class="filename">Arquivo: src/network.rs</span></p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
fn connect() {
}

mod server {
    fn connect() {
    }
}
#}</code></pre></pre>
<p>Observe que ainda temos uma declara√ß√£o <code>mod</code> dentro deste arquivo de m√≥dulo; isto √©
porque ainda queremos que <code>server</code> seja um subm√≥dulo de <code>network</code>.</p>
<p>Execute <code>cargo build</code> novamente. Sucesso! Temos mais um m√≥dulo para extrair: <code>server</code>.
Como ele √© um subm√≥dulo - ou seja, um m√≥dulo dentro de outro - nossa t√°tica atual de
extrair um m√≥dulo para um arquivo com o nome do m√≥dulo n√£o funcionar√°. Iremos
tentar, de qualquer maneira, para que voc√™ possa ver o erro. Primeiro, altere o arquivo <em>src/network.rs</em> colocando
<code>mod server;</code> no lugar do conte√∫do do m√≥dulo <code>server</code>:</p>
<p><span class="filename">Arquivo: src/network.rs</span></p>
<pre><code class="language-rust ignore">fn connect() {
}

mod server;
</code></pre>
<p>Em seguida, crie um arquivo <em>src/server.rs</em> e insira o conte√∫do do m√≥dulo <code>server</code>
que extra√≠mos:</p>
<p><span class="filename">Arquivo: src/server.rs</span></p>
<pre><pre class="playpen"><code class="language-rust">
# #![allow(unused_variables)]
#fn main() {
fn connect() {
}
#}</code></pre></pre>
<p>Quando tentamos <code>cargo build</code>, obteremos o erro mostrado na Listagem 7-5:</p>
<pre><code class="language-text">$ cargo build
   Compiling communicator v0.1.0 (file:///projects/communicator)
error: cannot declare a new module at this location
 --&gt; src/network.rs:4:5
  |
4 | mod server;
  |     ^^^^^^
  |
note: maybe move this module `src/network.rs` to its own directory via `src/network/mod.rs`
 --&gt; src/network.rs:4:5
  |
4 | mod server;
  |     ^^^^^^
note: ... or maybe `use` the module `server` instead of possibly redeclaring it
 --&gt; src/network.rs:4:5
  |
4 | mod server;
  |     ^^^^^^
</code></pre>
<p><span class="caption">Listagem 7-5: Erro ao tentar extrair o subm√≥dulo <code>server</code>
em <em>src/server.rs</em> </span></p>
<p>O erro diz que n√£o podemos declarar um novo m√≥dulo neste local (<code>cannot declare a new module at this location</code>)
e est√° apontando para a linha <code>mod server</code>; em <em>src/network.rs</em>. Ent√£o <em>src/network.rs</em> √©
diferente de <em>src/lib.rs</em> de alguma forma: continue lendo para entender o porqu√™.</p>
<p>A nota no meio da Listagem 7-5 √© realmente muito √∫til,
porque ela aponta para algo de que n√£o falamos ainda:</p>
<pre><code class="language-text">note: maybe move this module `network` to its own directory via
`network/mod.rs`
</code></pre>
<p>(<strong>Tradu√ß√£o:</strong> talvez mover este m√≥dulo network para o seu pr√≥prio diret√≥rio via <code>network/mod.rs</code>)</p>
<p>Em vez de continuar a seguir o mesmo padr√£o de nomea√ß√£o de arquivo usado
anteriormente, podemos fazer o que a nota sugere:</p>
<ol>
<li>Crie um novo <em>diret√≥rio</em> chamado <em>network</em>, o nome do m√≥dulo pai.</li>
<li>Mova o arquivo <em>src/network.rs</em> para o novo diret√≥rio <em>network</em> e
¬†¬†¬† renomeie para <em>src/network/mod.rs</em>.</li>
<li>Mova o arquivo de subm√≥dulo <em>src/server.rs</em> para o diret√≥rio <em>network</em>.</li>
</ol>
<p>Aqui est√£o os comandos para executar estas etapas:</p>
<pre><code class="language-text">$ mkdir src/network
$ mv src/network.rs src/network/mod.rs
$ mv src/server.rs src/network
</code></pre>
<p>Agora, quando tentamos executar <code>cargo build</code>, a compila√ß√£o funcionar√° (embora ainda teremos
avisos). O layout dos nossos m√≥dulos ainda √© exatamente o
mesmo de quando t√≠nhamos todo o c√≥digo em <em>src/lib.rs</em> na Listagem 7-3:</p>
<pre><code class="language-text">communicator
 ‚îú‚îÄ‚îÄ client
 ‚îî‚îÄ‚îÄ network
     ‚îî‚îÄ‚îÄ server
</code></pre>
<p>O layout dos arquivos correspondentes agora ficou assim:</p>
<pre><code class="language-text">‚îú‚îÄ‚îÄ src
‚îÇ   ‚îú‚îÄ‚îÄ client.rs
‚îÇ   ‚îú‚îÄ‚îÄ lib.rs
‚îÇ   ‚îî‚îÄ‚îÄ network
‚îÇ       ‚îú‚îÄ‚îÄ mod.rs
‚îÇ       ‚îî‚îÄ‚îÄ server.rs
</code></pre>
<p>Quando quer√≠amos extrair o m√≥dulo <code>network::server</code>, por que precis√°vamos
tamb√©m mudar o arquivo <em>src/network.rs</em> para o arquivo <em>src/network/mod.rs</em> e colocar
o c√≥digo de <code>network::server</code> no diret√≥rio <em>network</em> em
<em>src/network/server.rs</em> em vez de apenas extrair o
m√≥dulo <code>network::server</code> em <em>src/server.rs</em>? O motivo √© que Rust n√£o
ser√° capaz de reconhecer que <code>server</code> deveria ser um subm√≥dulo de <code>network</code>
se o arquivo <em>server.rs</em> estiver no diret√≥rio <em>src</em>. Para esclarecer o comportamento de Rust
aqui, consideremos um exemplo diferente com a seguinte hierarquia de m√≥dulos,
onde todas as defini√ß√µes est√£o em <em>src/lib.rs</em>:</p>
<pre><code class="language-text">communicator
 ‚îú‚îÄ‚îÄ client
 ‚îî‚îÄ‚îÄ network
     ‚îî‚îÄ‚îÄ client
</code></pre>
<p>Neste exemplo, temos novamente tr√™s m√≥dulos : <code>client</code>,<code>network</code>, e
<code>network::client</code>. Seguindo os mesmos passos anteriores para extrair
m√≥dulos em arquivos, poder√≠amos criar <em>src/client.rs</em> para o m√≥dulo <code>client</code>.
Para o m√≥dulo <code>network</code>, poder√≠amos criar <em>src/network.rs</em>. Mas n√£o ser√≠amos
capazes de extrair o m√≥dulo <code>network::client</code> para um arquivo <em>src/client.rs</em>
porque ele j√° existe para o m√≥dulo <code>client</code> de n√≠vel superior! Se pud√©ssemos colocar
o c√≥digo para <em>ambos</em> os m√≥dulos <code>client</code> e<code>network::client</code> no arquivo
<em>src/client.rs</em>, Rust n√£o teria nenhuma maneira de saber se o c√≥digo era
para <code>client</code> ou para <code>network::client</code>.</p>
<p>Portanto, para extrair um arquivo para o subm√≥dulo <code>network::client</code> do
m√≥dulo <code>network</code>, precisamos criar um diret√≥rio para o m√≥dulo <code>network</code>
em vez de um arquivo <em>src/network.rs</em>. O c√≥digo que est√° no m√≥dulo <code>network</code>
entra no arquivo <em>src/network/mod.rs</em>, e o subm√≥dulo
<code>network::client</code> pode ter seu pr√≥prio arquivo <em>src/network/client.rs</em>. Agora o
o n√≠vel superior <em>src/client.rs</em> √© inequivocamente o c√≥digo que pertence ao
m√≥dulo <code>client</code>.</p>
<a class="header" href="ch07-01-mod-and-the-filesystem.html#regras-dos-m√≥dulos-e-seus-arquivos" id="regras-dos-m√≥dulos-e-seus-arquivos"><h3>Regras dos M√≥dulos e Seus Arquivos</h3></a>
<p>Vamos resumir as regras dos m√≥dulos em rela√ß√£o aos arquivos:</p>
<ul>
<li>Se um m√≥dulo chamado <code>foo</code> n√£o possui subm√≥dulos, voc√™ deve colocar as declara√ß√µes
¬†¬† para <code>foo</code> em um arquivo chamado <em>foo.rs</em>.</li>
<li>Se um m√≥dulo chamado <code>foo</code> possui subm√≥dulos, voc√™ deve colocar as declara√ß√µes
¬†¬† para <code>foo</code> em um arquivo chamado <em>foo/mod.rs</em>.</li>
</ul>
<p>Essas regras se aplicam de forma recursiva, ent√£o, se um m√≥dulo chamado <code>foo</code> tiver um subm√≥dulo chamado
<code>bar</code> e<code>bar</code> n√£o possui subm√≥dulos, voc√™ deve ter os seguintes arquivos
no seu diret√≥rio <em>src</em>:</p>
<pre><code class="language-text">‚îú‚îÄ‚îÄ foo
‚îÇ   ‚îú‚îÄ‚îÄ bar.rs (cont√©m as declara√ß√µes em `foo::bar`)
‚îÇ   ‚îî‚îÄ‚îÄ mod.rs (cont√©m as declara√ß√µes em `foo`, incluindo `mod bar`)
</code></pre>
<p>Os m√≥dulos devem ser declarados no arquivo do m√≥dulo pai usando a palavra-chave <code>mod</code>.</p>
<p>Em seguida, vamos falar sobre a palavra-chave <code>pub</code> e nos livrar dessas warnings!</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="ch07-00-modules.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="ch07-02-controlling-visibility-with-pub.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a href="ch07-00-modules.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a href="ch07-02-controlling-visibility-with-pub.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>


        <!-- Local fallback for Font Awesome -->
        <script>
            if (getComputedStyle(document.querySelector(".fa")).fontFamily !== "FontAwesome") {
                var link = document.createElement('link');
                link.rel = 'stylesheet';
                link.type = 'text/css';
                link.href = '_FontAwesome/css/font-awesome.css';
                document.head.insertBefore(link, document.head.firstChild)
            }
        </script>

        

        

        

        

        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS script -->
        

    </body>
</html>
